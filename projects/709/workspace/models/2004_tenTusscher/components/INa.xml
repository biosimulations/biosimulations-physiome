<?xml version="1.0" encoding="iso-8859-1"?>
<model
    name="ten_tusscher_model_2004_INa"
    cmeta:id="ten_tusscher_model_2004_INa"
    xmlns="http://www.cellml.org/cellml/1.1#"
    xmlns:cellml="http://www.cellml.org/cellml/1.1#"
    xmlns:cmeta="http://www.cellml.org/metadata/1.0#"
    xmlns:xlink="http://www.w3.org/1999/xlink">
  <rdf:RDF
      xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
      xmlns:cmeta="http://www.cellml.org/metadata/1.0#"
      xmlns:bqs="http://www.cellml.org/bqs/1.0#"
      xmlns:dc="http://purl.org/dc/elements/1.1/"
      xmlns:dcterms="http://purl.org/dc/terms/"
      xmlns:vCard="http://www.w3.org/2001/vcard-rdf/3.0#">
    <rdf:Description rdf:about="">
      <dc:creator rdf:parseType="Resource">
        <vCard:N rdf:parseType="Resource">
          <vCard:Family>Nickerson</vCard:Family>
          <vCard:Given>David</vCard:Given>
        </vCard:N>
        <vCard:EMAIL rdf:parseType="Resource">
          <rdf:value>d.nickerson@auckland.ac.nz</rdf:value>
          <rdf:type rdf:resource="http://imc.org/vCard/3.0#internet"/>
        </vCard:EMAIL>
        <vCard:ORG rdf:parseType="Resource">
          <vCard:Orgname>The University of Auckland</vCard:Orgname>
          <vCard:Orgunit>Bioengineering Institute</vCard:Orgunit>
        </vCard:ORG>
      </dc:creator>
      <dcterms:created rdf:parseType="Resource">
        <dcterms:W3CDTF>2004-12-27</dcterms:W3CDTF>
      </dcterms:created>
      <dc:publisher>
        Bioengineering Institute, The University of Auckland
      </dc:publisher>
    </rdf:Description>
    <rdf:Description rdf:about="#ten_tusscher_model_2004_INa">
      <dc:title>
        The fast sodium current from the ten Tusscher et al. 2004 human
        ventricular AP model.
      </dc:title>
      <cmeta:comment rdf:parseType="Resource">
        <rdf:value>
          This is the CellML description of the fast sodium current 
          from the ten Tusscher et al. 2004 mathematical 
          model of human ventricular cellular action potential.
        </rdf:value>
        <dc:creator rdf:parseType="Resource">
          <vCard:FN>David Nickerson</vCard:FN>
        </dc:creator>
      </cmeta:comment>
      <cmeta:species>Homo sapiens</cmeta:species>
      <cmeta:bio_entity>Ventricular Myocyte</cmeta:bio_entity>
      <bqs:reference rdf:parseType="Resource">
        <dc:subject rdf:parseType="Resource">
          <bqs:subject_type>keyword</bqs:subject_type>
          <rdf:value>
            <rdf:Bag>
              <rdf:li>Ventricular Myocyte</rdf:li>
              <rdf:li>cardiac</rdf:li>
              <rdf:li>electrophysiology</rdf:li>
              <rdf:li>fast sodium current</rdf:li>
            </rdf:Bag>
          </rdf:value>
        </dc:subject>
      </bqs:reference>
      <bqs:reference rdf:parseType="Resource">
        <bqs:Pubmed_id>14656705</bqs:Pubmed_id>
        <bqs:JournalArticle rdf:parseType="Resource">
          <dc:creator>
            <rdf:Seq>
              <rdf:li rdf:parseType="Resource">
                <bqs:Person rdf:parseType="Resource">
                  <vCard:N rdf:parseType="Resource">
                    <vCard:Family>ten Tusscher</vCard:Family>
                    <vCard:Given>K</vCard:Given>
                    <vCard:Other>H</vCard:Other>
                    <vCard:Other>W</vCard:Other>
                    <vCard:Other>J</vCard:Other>
                  </vCard:N>
                </bqs:Person>
              </rdf:li>
              <rdf:li rdf:parseType="Resource">
                <bqs:Person rdf:parseType="Resource">
                  <vCard:N rdf:parseType="Resource">
                    <vCard:Family>Noble</vCard:Family>
                    <vCard:Given>D</vCard:Given>
                  </vCard:N>
                </bqs:Person>
              </rdf:li>
              <rdf:li rdf:parseType="Resource">
                <bqs:Person rdf:parseType="Resource">
                  <vCard:N rdf:parseType="Resource">
                    <vCard:Family>Noble</vCard:Family>
                    <vCard:Given>P</vCard:Given>
                    <vCard:Other>J</vCard:Other>
                  </vCard:N>
                </bqs:Person>
              </rdf:li>
              <rdf:li rdf:parseType="Resource">
                <bqs:Person rdf:parseType="Resource">
                  <vCard:N rdf:parseType="Resource">
                    <vCard:Family>Panfilov</vCard:Family>
                    <vCard:Given>A</vCard:Given>
                    <vCard:Other>V</vCard:Other>
                  </vCard:N>
                </bqs:Person>
              </rdf:li>
            </rdf:Seq>
          </dc:creator>
          <dc:title>
            A model for human ventricular tissue
          </dc:title>
          <dcterms:issued rdf:parseType="Resource">
            <dcterms:W3CDTF>2004-04</dcterms:W3CDTF>
          </dcterms:issued>
          <bqs:Journal rdf:parseType="Resource">
            <dc:title>American Journal of Physiology</dc:title>
          </bqs:Journal>
          <bqs:volume>286</bqs:volume>
          <bqs:first_page>H1573</bqs:first_page>
          <bqs:last_page>H1589</bqs:last_page>
        </bqs:JournalArticle>
      </bqs:reference>
    </rdf:Description>
  </rdf:RDF>
  
  <import xlink:href="../../common/units.xml">
    <units name="ms" units_ref="ms"/>
    <units name="mscu" units_ref="mscu"/>
    <units name="per_ms" units_ref="per_ms"/>
    <units name="mV" units_ref="mV"/>
    <units name="per_mV" units_ref="per_mV"/>
    <units name="nS_per_pF" units_ref="nS_per_pF"/>
    <units name="pA_per_pF" units_ref="pA_per_pF"/>
    <units name="per_mV_per_ms" units_ref="per_mV_per_ms"/>
  </import>
  
  <component name="INa" cmeta:id="INa">
    <rdf:RDF
      xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
      xmlns:cmeta="http://www.cellml.org/metadata/1.0#">
      <rdf:Description rdf:about="#INa">
        <cmeta:comment rdf:parseType="Resource">
          <rdf:value>
            Here we calculate the fast sodium current. We expect the time, membrane
            potential, reversal potential and conductance to be set externally, and
            we provide access to the gating variables and the calculated current. This
            component encapsulates all others in this model.
          </rdf:value>
        </cmeta:comment>
      </rdf:Description>
    </rdf:RDF>

    <variable name="INa" public_interface="out" units="pA_per_pF"/>
    
    <variable name="time" public_interface="in" private_interface="out" units="ms"/>
    <variable name="V" public_interface="in" private_interface="out" units="mV"/>
    <variable name="E_Na" public_interface="in" units="mV"/>
    <variable name="g_Na" public_interface="in" units="nS_per_pF"/>
    
    <variable name="m" public_interface="out" private_interface="in" units="dimensionless"/>
    <variable name="h" public_interface="out" private_interface="in" units="dimensionless"/>
    <variable name="j" public_interface="out" private_interface="in" units="dimensionless"/>
    <variable name="m_initial" public_interface="in" private_interface="out" units="dimensionless"/>
    <variable name="h_initial" public_interface="in" private_interface="out" units="dimensionless"/>
    <variable name="j_initial" public_interface="in" private_interface="out" units="dimensionless"/>
    
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="INa_calculation"><eq/>
        <ci>INa</ci>
        <apply><times/>
          <ci>g_Na</ci>
          <apply><power/>
            <ci>m</ci>
            <cn cellml:units="dimensionless">3.0</cn>
          </apply>
          <ci>h</ci>
          <ci>j</ci>
          <apply><minus/>
            <ci>V</ci>
            <ci>E_Na</ci>
          </apply>
        </apply>
      </apply>
    </math>
  </component>
  
  <component name="m_gate" cmeta:id="m_gate">
    <rdf:RDF
      xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
      xmlns:cmeta="http://www.cellml.org/metadata/1.0#">
      <rdf:Description rdf:about="#m_gate">
        <cmeta:comment rdf:parseType="Resource">
          <rdf:value>
            The activation gate. Here we specify the standard Hodgkin-Huxley
            type kinetics for the gate and also calculate the steady-state
            m_infinity and tau_m values.
          </rdf:value>
        </cmeta:comment>
      </rdf:Description>
    </rdf:RDF>

    <variable name="m" initial_value="m_initial" public_interface="out" units="dimensionless"/>
    <variable name="m_initial" public_interface="in" units="dimensionless"/>
    
    <variable name="tau_m" public_interface="out" units="ms"/>
    <variable name="m_infinity" public_interface="out" units="dimensionless"/>
        
    <variable name="alpha_m" units="per_ms"/>
    <variable name="beta_m" units="per_ms"/>

    <variable name="V" public_interface="in" units="mV"/>
    <variable name="time" public_interface="in" units="ms"/>
   
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="m_infinity_calculation"><eq/>
        <ci>m_infinity</ci>
        <apply><divide/>
          <cn cellml:units="dimensionless">1.0</cn>
          <apply><power/>
            <apply><plus/>
              <cn cellml:units="dimensionless">1.0</cn>
              <apply><exp/>
                <apply><divide/>
                  <apply><minus/>
                    <cn cellml:units="mV">-56.86</cn>
                    <ci>V</ci>
                  </apply>
                  <cn cellml:units="mV">9.03</cn>
                </apply>
              </apply>
            </apply>
            <cn cellml:units="dimensionless">2.0</cn>
          </apply>
        </apply>
      </apply>
      
      <apply id="alpha_m_calculation"><eq/>
        <ci>alpha_m</ci>
        <apply><divide/>
          <cn cellml:units="per_ms">1.0</cn>
          <apply><plus/>
            <cn cellml:units="dimensionless">1.0</cn>
            <apply><exp/>
              <apply><divide/>
                <apply><minus/>
                  <cn cellml:units="mV">-60.0</cn>
                  <ci>V</ci>
                </apply>
                <cn cellml:units="mV">5.0</cn>
              </apply>
            </apply>
          </apply>
        </apply>
      </apply>
      
      <apply id="beta_m_calculation"><eq/>
        <ci>beta_m</ci>
        <apply><plus/>
          <apply><divide/>
            <cn cellml:units="per_ms">0.1</cn>
            <apply><plus/>
              <cn cellml:units="dimensionless">1.0</cn>
              <apply><exp/>
                <apply><divide/>
                  <apply><plus/>
                    <cn cellml:units="mV">35.0</cn>
                    <ci>V</ci>
                  </apply>
                  <cn cellml:units="mV">5.0</cn>
                </apply>
              </apply>
            </apply>
          </apply>
          <apply><divide/>
            <cn cellml:units="per_ms">0.1</cn>
            <apply><plus/>
              <cn cellml:units="dimensionless">1.0</cn>
              <apply><exp/>
                <apply><divide/>
                  <apply><minus/>
                    <ci>V</ci>
                    <cn cellml:units="mV">50.0</cn>
                  </apply>
                  <cn cellml:units="mV">200.0</cn>
                </apply>
              </apply>
            </apply>
          </apply>
        </apply>
      </apply>
      
      <apply id="tau_m_calculation"><eq/>
        <ci>tau_m</ci>
        <apply><times/>
          <cn cellml:units="mscu">1.0</cn>
          <ci>alpha_m</ci>
          <ci>beta_m</ci>
        </apply>
      </apply>
      
      <apply id="dm_dt"><eq/>
        <apply><diff/>
          <bvar><ci>time</ci></bvar>
          <ci>m</ci>
        </apply>
        <apply><divide/>
          <apply><minus/>
            <ci>m_infinity</ci>
            <ci>m</ci>
          </apply>
          <ci>tau_m</ci>
        </apply>
      </apply>
    </math>
  </component>
  
  <component name="h_gate" cmeta:id="h_gate">
    <rdf:RDF
      xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
      xmlns:cmeta="http://www.cellml.org/metadata/1.0#">
      <rdf:Description rdf:about="#h_gate">
        <cmeta:comment rdf:parseType="Resource">
          <rdf:value>
            The fast inactivation gate. Here we specify the standard Hodgkin-Huxley
            type kinetics for the gate and also calculate the steady-state
            h_infinity and tau_h values.
          </rdf:value>
        </cmeta:comment>
      </rdf:Description>
    </rdf:RDF>

    <variable name="h" initial_value="h_initial" public_interface="out" units="dimensionless"/>
    <variable name="h_initial" public_interface="in" units="dimensionless"/>
    
    <variable name="tau_h" public_interface="out" units="ms"/>
    <variable name="h_infinity" public_interface="out" units="dimensionless"/>
        
    <variable name="alpha_h" units="per_ms"/>
    <variable name="beta_h" units="per_ms"/>

    <variable name="V" public_interface="in" units="mV"/>
    <variable name="time" public_interface="in" units="ms"/>
    
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="h_infinity_calculation"><eq/>
        <ci>h_infinity</ci>
        <apply><divide/>
          <cn cellml:units="dimensionless">1.0</cn>
          <apply><power/>
            <apply><plus/>
              <cn cellml:units="dimensionless">1.0</cn>
              <apply><exp/>
                <apply><divide/>
                  <apply><plus/>
                    <cn cellml:units="mV">71.55</cn>
                    <ci>V</ci>
                  </apply>
                  <cn cellml:units="mV">7.43</cn>
                </apply>
              </apply>
            </apply>
            <cn cellml:units="dimensionless">2.0</cn>
          </apply>
        </apply>
      </apply>
      
      <apply id="alpha_h_calculation"><eq/>
        <ci>alpha_h</ci>
        <piecewise>
          <piece>
            <apply><times/>
              <cn cellml:units="per_ms">0.057</cn>
              <apply><exp/>
                <apply><divide/>
                  <apply><minus/>
                    <apply><plus/>
                      <cn cellml:units="mV">80.0</cn>
                      <ci>V</ci>
                    </apply>
                  </apply>
                  <cn cellml:units="mV">6.8</cn>
                </apply>
              </apply>
            </apply>
            <apply><lt/>
              <ci>V</ci>
              <cn cellml:units="mV">-40.0</cn>
            </apply>
          </piece>
          <otherwise>
            <cn cellml:units="per_ms">0.0</cn>
          </otherwise>
        </piecewise>
      </apply>
       
      <apply id="beta_h_calculation"><eq/>
        <ci>beta_h</ci>
        <piecewise>
          <piece>
            <apply><plus/>
              <apply><times/>
                <cn cellml:units="per_ms">2.7</cn>
                <apply><exp/>
                  <apply><times/>
                    <cn cellml:units="per_mV">0.079</cn>
                    <ci>V</ci>
                  </apply>
                </apply>
              </apply>
              <apply><times/>
                <cn cellml:units="per_ms">3.1E5</cn>
                <apply><exp/>
                  <apply><times/>
                    <cn cellml:units="per_mV">0.3485</cn>
                    <ci>V</ci>
                  </apply>
                </apply>
              </apply>
            </apply>
            <apply><lt/>
              <ci>V</ci>
              <cn cellml:units="mV">-40.0</cn>
            </apply>
          </piece>
          <otherwise>
            <apply><divide/>
              <cn cellml:units="dimensionless">0.77</cn>
              <apply><times/>
                <cn cellml:units="ms">0.13</cn>
                <apply><plus/>
                  <cn cellml:units="dimensionless">1.0</cn>
                  <apply><exp/>
                    <apply><divide/>
                      <apply><minus/>
                        <apply><plus/>
                          <ci>V</ci>
                          <cn cellml:units="mV">10.66</cn>
                        </apply>
                      </apply>
                      <cn cellml:units="mV">11.1</cn>
                    </apply>
                  </apply>
                </apply>
              </apply>
            </apply>
          </otherwise>
        </piecewise>
      </apply>
      
      <apply id="tau_h_calculation"><eq/>
        <ci>tau_h</ci>
        <apply><divide/>
          <cn cellml:units="dimensionless">1.0</cn>
          <apply><plus/>
            <ci>alpha_h</ci>
            <ci>beta_h</ci>
          </apply>
        </apply>
      </apply>
      
      <apply id="dh_dt"><eq/>
        <apply><diff/>
          <bvar><ci>time</ci></bvar>
          <ci>h</ci>
        </apply>
        <apply><divide/>
          <apply><minus/>
            <ci>h_infinity</ci>
            <ci>h</ci>
          </apply>
          <ci>tau_h</ci>
        </apply>
      </apply>
    </math>
  </component>
  
  <component name="j_gate" cmeta:id="j_gate">
    <rdf:RDF
      xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
      xmlns:cmeta="http://www.cellml.org/metadata/1.0#">
      <rdf:Description rdf:about="#j_gate">
        <cmeta:comment rdf:parseType="Resource">
          <rdf:value>
            The slow inactivation gate. Here we specify the standard Hodgkin-Huxley
            type kinetics for the gate and also calculate the steady-state
            j_infinity and tau_j values.
          </rdf:value>
        </cmeta:comment>
      </rdf:Description>
    </rdf:RDF>
    
    <variable name="j" initial_value="j_initial" public_interface="out" units="dimensionless"/>
    <variable name="j_initial" public_interface="in" units="dimensionless"/>

    <variable name="tau_j" public_interface="out" units="ms"/>
    <variable name="j_infinity" public_interface="out" units="dimensionless"/>
        
    <variable name="alpha_j" units="per_ms"/>
    <variable name="beta_j" units="per_ms"/>

    <variable name="V" public_interface="in" units="mV"/>
    <variable name="time" public_interface="in" units="ms"/>
    
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="j_infinity_calculation"><eq/>
        <ci>j_infinity</ci>
        <apply><divide/>
          <cn cellml:units="dimensionless">1.0</cn>
          <apply><power/>
            <apply><plus/>
              <cn cellml:units="dimensionless">1.0</cn>
              <apply><exp/>
                <apply><divide/>
                  <apply><plus/>
                    <cn cellml:units="mV">71.55</cn>
                    <ci>V</ci>
                  </apply>
                  <cn cellml:units="mV">7.43</cn>
                </apply>
              </apply>
            </apply>
            <cn cellml:units="dimensionless">2.0</cn>
          </apply>
        </apply>
      </apply>
    
      <apply id="alpha_j_calculation"><eq/>
        <ci>alpha_j</ci>
        <piecewise>
          <piece>
            <apply><divide/>
              <apply><times/>
                <apply><minus/>
                  <apply><times/>
                    <cn cellml:units="per_mV_per_ms">-2.5428E4</cn>
                    <apply><exp/>
                      <apply><times/>
                        <cn cellml:units="per_mV">0.2444</cn>
                        <ci>V</ci>
                      </apply>
                    </apply>
                  </apply>
                  <apply><times/>
                    <cn cellml:units="per_mV_per_ms">6.948E-6</cn>
                    <apply><exp/>
                      <apply><times/>
                        <cn cellml:units="per_mV">-0.04391</cn>
                        <ci>V</ci>
                      </apply>
                    </apply>
                  </apply>
                </apply>
                <apply><plus/>
                  <ci>V</ci>
                  <cn cellml:units="mV">37.78</cn>
                </apply>
              </apply>
              <apply><plus/>
                <cn cellml:units="dimensionless">1.0</cn>
                <apply><exp/>
                  <apply><times/>
                    <cn cellml:units="per_mV">0.311</cn>
                    <apply><plus/>
                      <ci>V</ci>
                      <cn cellml:units="mV">79.23</cn>
                    </apply>
                  </apply>
                </apply>
              </apply>
            </apply>
            <apply><lt/>
              <ci>V</ci>
              <cn cellml:units="mV">-40.0</cn>
            </apply>
          </piece>
          <otherwise>
            <cn cellml:units="per_ms">0.0</cn>
          </otherwise>
        </piecewise>
      </apply>
       
      <apply id="beta_j_calculation"><eq/>
        <ci>beta_j</ci>
        <piecewise>
          <piece>
            <apply><divide/>
              <apply><times/>
                <cn cellml:units="per_ms">0.02424</cn>
                <apply><exp/>
                  <apply><times/>
                    <cn cellml:units="per_mV">-0.01052</cn>
                    <ci>V</ci>
                  </apply>
                </apply>
              </apply>
              <apply><plus/>
                <cn cellml:units="dimensionless">1.0</cn>
                <apply><exp/>
                  <apply><times/>
                    <cn cellml:units="per_mV">-0.1378</cn>
                    <apply><plus/>
                      <ci>V</ci>
                      <cn cellml:units="mV">40.14</cn>
                    </apply>
                  </apply>
                </apply>
              </apply>
            </apply>
            <apply><lt/>
              <ci>V</ci>
              <cn cellml:units="mV">-40.0</cn>
            </apply>
          </piece>
          <otherwise>
            <apply><divide/>
              <apply><times/>
                <cn cellml:units="per_ms">0.6</cn>
                <apply><exp/>
                  <apply><times/>
                    <cn cellml:units="per_mV">0.057</cn>
                    <ci>V</ci>
                  </apply>
                </apply>
              </apply>
              <apply><plus/>
                <cn cellml:units="dimensionless">1.0</cn>
                <apply><exp/>
                  <apply><times/>
                    <cn cellml:units="per_mV">-0.1</cn>
                    <apply><plus/>
                      <ci>V</ci>
                      <cn cellml:units="mV">32.0</cn>
                    </apply>
                  </apply>
                </apply>
              </apply>
            </apply>
          </otherwise>
        </piecewise>
      </apply>
      
      <apply id="tau_j_calculation"><eq/>
        <ci>tau_j</ci>
        <apply><divide/>
          <cn cellml:units="dimensionless">1.0</cn>
          <apply><plus/>
            <ci>alpha_j</ci>
            <ci>beta_j</ci>
          </apply>
        </apply>
      </apply>
      
      <apply id="dj_dt"><eq/>
        <apply><diff/>
          <bvar><ci>time</ci></bvar>
          <ci>j</ci>
        </apply>
        <apply><divide/>
          <apply><minus/>
            <ci>j_infinity</ci>
            <ci>j</ci>
          </apply>
          <ci>tau_j</ci>
        </apply>
      </apply>
    </math>
  </component>

  <group>
    <relationship_ref relationship="encapsulation"/>
    <component_ref component="INa">
      <component_ref component="m_gate"/>
      <component_ref component="h_gate"/>
      <component_ref component="j_gate"/>
    </component_ref>
  </group>

  <connection>
    <map_components component_1="INa" component_2="m_gate"/>
    <map_variables variable_1="m" variable_2="m"/>
    <map_variables variable_1="m_initial" variable_2="m_initial"/>
    <map_variables variable_1="time" variable_2="time"/>
    <map_variables variable_1="V" variable_2="V"/>
  </connection>  
  <connection>
    <map_components component_1="INa" component_2="h_gate"/>
    <map_variables variable_1="h" variable_2="h"/>
    <map_variables variable_1="h_initial" variable_2="h_initial"/>
    <map_variables variable_1="time" variable_2="time"/>
    <map_variables variable_1="V" variable_2="V"/>
  </connection>
  <connection>
    <map_components component_1="INa" component_2="j_gate"/>
    <map_variables variable_1="j" variable_2="j"/>
    <map_variables variable_1="j_initial" variable_2="j_initial"/>
    <map_variables variable_1="time" variable_2="time"/>
    <map_variables variable_1="V" variable_2="V"/>
  </connection>

</model>
